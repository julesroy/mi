on:
  push:
    branches:
      - deploiement
name: üñ•Ô∏è D√©ploiement
jobs:
  FTP-Deploy-Action:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: üì¢ D√©but du d√©ploiement
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content": "üöÄ D√©ploiement lanc√© sur la branche `deploiement`."}' \
               ${{ secrets.DISCORD_WEBHOOK_URL }}

      - name: ‚ö° FTP-Deploy-Action
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: ${{ secrets.SFTP_SERVER }}
          username: ${{ secrets.SFTP_USERNAME }}
          password: ${{ secrets.SFTP_PASSWORD }}
          exclude: |
            **/vendor/**
            **/dev/**
            **/documentation/**
            .env
            .env.example
            artisan
            .gitignore
            .gitattributes
            .editorconfig
            .prettierrc
            jsdoc.json
            nodemon.json
            package.json
            package-lock.json
            phpdoc.dist.xml
            phpDocumentor.phar
            README.md
            tailwind.config.js
            .git/**
          local-dir: ./
          server-dir: www/

      - name: ‚úÖ Fin du d√©ploiement
        if: success()
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content": "‚úÖ D√©ploiement termin√© avec succ√®s ! üéâ"}' \
               ${{ secrets.DISCORD_WEBHOOK_URL }}

      - name: ‚ùå √âchec du d√©ploiement
        if: failure()
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{"content": "‚ùå √âchec du d√©ploiement sur la branche `deploiement`."}' \
               ${{ secrets.DISCORD_WEBHOOK_URL }}